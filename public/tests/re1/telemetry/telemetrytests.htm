<HTML>
<HEAD>
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="expires" content="0">
<meta http-equiv="Telemetry" content="QueryFrequency:5000">
<META HTTP-Equiv="Telemetry" Content="Enable:RoadSpeed;Enable:EngineRPM;Enable:TotalDistance;Enable:EngineLoad;Enable:ABSControlStatus">
<META HTTP-Equiv="Telemetry" Content="Enable:ThrottlePosition;Enable:ServiceBrakeSwitch;Enable:IgnitionStatus;Enable:ParkingBrakeSwitch;Enable:CruiseControlSwitch">
<META HTTP-Equiv="Telemetry" Content="Enable:BrakesSwitch;Enable:ClutchStatus;Enable:CruiseControlSetSpeed;Enable:AcceleratorPedalPos;Enable:EngineOilPressure">
<META HTTP-Equiv="Telemetry" Content="Enable:BoostPressure;Enable:EngineCoolantTemperature;Enable:EngineRetarderStatus;Enable:ATC_ASR_Status;Enable:TransmissionRangeSelected">

<TITLE>Telemetry Tests</TITLE>
  <script type="text/javascript">

  var gen = new ActiveXObject("PocketBrowser.Generic");
  
  function startTelemetryArray()
  {
	gen.InvokeMETAFunction("Telemetry", "TelemetryArrayEvent:url('javascript:onTelemetryArrayJSON(%json);');");
	gen.InvokeMETAFunction("Telemetry", "TelemetryDataEvent:url('');");
  }
  var bArrayOne = false;
  function onTelemetryArrayJSON(jsonObject)
  {
	bArrayOne = !bArrayOne;
  	 var html = "<b>Filter Name: Data, Units, Time</b><br>";
	 for(i=0; i<jsonObject.FilterValueArray.length; i++)	
     {
       html += '' + jsonObject.FilterValueArray[i].FilterName + ': ' 
	        + jsonObject.FilterValueArray[i].FilterValue + ', ';
	        + jsonObject.FilterValueArray[i].UnitOfMeasurement + ', ';
	        + jsonObject.FilterValueArray[i].LastUpdate + '<br>';
     }
	html += "</TABLE>"
	if (bArrayOne)
		telemetryArray1.innerHTML = html;
	else
		telemetryArray2.innerHTML = html;
	
  }
  
  function startTelemetryNVP()
  {
	gen.InvokeMETAFunction("Telemetry", "TelemetryArrayEvent:url('');");
	gen.InvokeMETAFunction("Telemetry", "TelemetryDataEvent:url('javascript:onTelemetry('%s', '%s', '%s', '%s');');");
  }
  

    function onTelemetry(filter, data, units, time) 
	{
        if (filter == "RoadSpeed")
            roadSpeedSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "EngineRPM")
            engineRPMSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "TotalDistance")
            totalDistanceSpan.innerText = data + " " + units + " at " + time;
 /*       else if (filter == "EngineLoad")
            engineLoadSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "ABSControlStatus")
            absControlStatusSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "ThrottlePosition")
            throttlePositionSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "ServiceBrakeSwitch")
            serviceBrakeSwitchSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "IgnitionStatus")
            ignitionStatusSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "ParkingBrakeSwitch")
            parkingBrakeSwitchSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "CruiseControlSwitch")
            cruiseControlSwitchSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "BrakesSwitch")
            brakesSwitchSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "ClutchStatus")
            clutchStatusSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "CruiseControlSetSpeed")
            cruiseControlSetSpeedSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "AcceleratorPedalPos")
            acceleratorPedalPosSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "EngineOilPressure")
            engineOilPressureSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "BoostPressure")
            boostPressureSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "EngineCoolantTemperature")
            engineCoolantTemperatureSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "EngineRetarderStatus")
            engineRetarderStatusSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "ATC_ASR_Status")
            atc_asr_StatusSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "TransmissionRangeSelected")
            transmissionRangeSelectedSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "TransmissionRangeAttained")
            transmissionRangeAttainedSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "BatteryVoltage")
            batteryVoltageSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "EngineOilTemperature")
            engineOilTemperatureSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "TransmissionOilTemperature")
            transmissionOilTemperatureSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "FuelRate")
            fuelRateSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "InstantaneousFuelEconomy")
            instantaneousFuelEconomySpan.innerText = data + " " + units + " at " + time;
        else if (filter == "AverageFuelEconomy")
            averageFuelEconomySpan.innerText = data + " " + units + " at " + time;
        else if (filter == "TransmitterDiagnosticTable")
            transmitterDiagnosticTableSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "TransmitterDiagnosticCode")
            transmitterDiagnosticCodeSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "VehicleIDNumber")
            vehicleIDNumberSpan.innerText = data + " " + units + " at " + time;
        else if (filter == "VehicleGlobalPosition")
            vehicleGlobalPositionSpan.innerText = data + " " + units + " at " + time;
		*/
    }

    
  </script>
</HEAD>

<H1>Telemetry Tests</H1>
<P>
	<DIV id="telemetryArray1">Telemetry Data will appear here (Array 1)</div>
	<DIV id="telemetryArray2">Telemetry Data will appear here (Array 2)</div>
	<br>
Speed	: <span id=roadSpeedSpan>Road Speed (NVP)</span><br>
RPM		: <span id=engineRPMSpan>RPM (NVP)</span><br>
Distance	: <span id=totalDistanceSpan></span><br>
<!-- 
Load		: <span id=engineLoadSpan></span><br>
ABS		: <span id=absControlStatusSpan></span><br>
Throttle	: <span id=throttlePositionSpan></span><br>
Service		: <span id=serviceBrakeSwitchSpan></span><br>
Ignition	: <span id=ignitionStatusSpan></span><br>
Parking		: <span id=parkingBrakeSwitchSpan></span><br>
Cruise		: <span id=cruiseControlSwitchSpan></span><br>
Brakes		: <span id=brakesSwitchSpan></span><br>
Clutch		: <span id=clutchStatusSpan></span><br>
Cruise		: <span id=cruiseControlSetSpeedSpan></span><br>
Accelerator	: <span id=acceleratorPedalPosSpan></span><br>
EngineOil	: <span id=engineOilPressureSpan></span><br>
Boost		: <span id=boostPressureSpan></span><br>
EngineCoolant	: <span id=engineCoolantTemperatureSpan></span><br>
EngineRetarder	: <span id=engineRetarderStatusSpan></span><br>
ATC_ASR		: <span id=atc_asr_StatusSpan></span><br>
TRselected	: <span id=transmissionRangeSelectedSpan></span><br>
TRattained	: <span id=transmissionRangeAttainedSpan></span><br>
Battery		: <span id=batteryVoltageSpan></span><br>
Temperature	: <span id=engineOilTemperatureSpan></span><br>
Transmission	: <span id=transmissionOilTemperatureSpan></span><br>
Fuel		: <span id=fuelRateSpan></span><br>
Instantaneous	: <span id=instantaneousFuelEconomySpan></span><br>
Average		: <span id=averageFuelEconomySpan></span><br>
Transmitter	: <span id=transmitterDiagnosticTableSpan></span><br>
Code		: <span id=transmitterDiagnosticCodeSpan></span><br>
VehicleID	: <span id=vehicleIDNumberSpan></span><br>
Global		: <span id=vehicleGlobalPositionSpan></span><br>
-->
  <BR>
  <INPUT align="center" type="button" value="Retrieve Telemetry via Array" onclick="startTelemetryArray();">
  <INPUT align="center" type="button" value="Retrieve Telemetry via NVP" onclick="startTelemetryNVP();">
	<br>
	Please ensure the simulator is running on the device (if no hardware present), running VBusSample should achieve this.
  </BODY>
</HTML>