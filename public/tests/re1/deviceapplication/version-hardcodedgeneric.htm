<HTML>
<HEAD>
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="expires" content="0">
<TITLE>Application Tests</TITLE>

  <script type="text/javascript">


	function fnVer(productVersion, hotFixes, componentVersions)
	{
		var theOutput = "<B>Product Version:</b> " + productVersion + "<P>";
		theOutput = theOutput + "<b>Hot Fixes:</b><P>";
		for (var i=0; i<hotFixes.length; i = i + 1)
		{
			theOutput = theOutput + "  Hot Fix: " + hotFixes[i] + "<BR>";
		}
		theOutput = theOutput + "<P>";
		theOutput = theOutput + "<b>Installed Components:</b><P>";
		for (var j=0; j<componentVersions.length; j = j + 1)
		{
			theOutput = theOutput + "  Component: " + componentVersions[j][0] + ': ' + componentVersions[j][1] + "<BR>";
		}
		outputDiv.innerHTML = theOutput;
	}
		  
	function getVer()  
	{
		generic.InvokeMETAFunction("Application", "VersionEvent:url('javascript:fnVer('%s', %s, %s);'); GetVersion");
	}
	
	//  JSON JSON JSON JSON JSON JSON JSON JSON JSON JSON JSON JSON
	
	function fnVerJSON(jsonObject)
	{
		var theOutput = "<B>Product Version:</b> " + jsonObject.ProductVersion + "<P>";
		theOutput = theOutput + "<b>Hot Fixes:</b><P>";
		for (var i=0; i<jsonObject.HotFixes.length; i = i + 1)
		{
			theOutput = theOutput + "  Hot Fix: " + jsonObject.HotFixes[i] + "<BR>";
		}
		theOutput = theOutput + "<P>";
		theOutput = theOutput + "<b>Installed Components:</b><P>";
		for (var j=0; j<jsonObject.ComponentVersions.length; j = j + 1)
		{
			theOutput = theOutput + "  Module: " + jsonObject.ComponentVersions[j].Module + ', Version: ' + jsonObject.ComponentVersions[j].Version + "<BR>";
		}
		outputDiv.innerHTML = theOutput;
	}
	
	function getVerJSON()  
	{
		generic.InvokeMETAFunction("Application", "VersionEvent:url('javascript:fnVerJSON(%json);'); GetVersion");
	}

  
  </script>
</HEAD>

<H1>Version Tests</H1>
<P>
<embed id="embed1" type="application/x-wtg-legacy-generic" hidden="true"> </embed> 

<div id="outputDiv">Version Goes Here</div>
<P>
  <INPUT align="center" type="button" value="Retrieve Version (JS Array)" onclick="getVer();"><br>
  <INPUT align="center" type="button" value="Retrieve Version (JSON)" onclick="getVerJSON();"><br>
<br>  
  <INPUT align="center" type="button" value="Manual Test (JS Array)" onclick="fnVer('1.2.3', new Array('1','2'), new Array(new Array('hello','darryn'),new Array('greetings','darryns friend')));"><br>
  <INPUT align="center" type="button" value="Manual Test (JSON)" onclick="fnVerJSON({'ProductVersion':'1.2.3','HotFixes':['7','4','2'],'ComponentVersions':[{'Module':'Timer','Version':'1.0.6.1'},{'Module':'Scanner','Version':'1.0.6.5'}]});"><br>
<a href="javascript:location.reload();">Refresh the page</a>





</HTML>