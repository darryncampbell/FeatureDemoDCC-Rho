<HTML>
<HEAD>
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="expires" content="0">
<TITLE>Application Tests</TITLE>
</HEAD>
<BODY>
  <script type="text/javascript">

	  
	function fnVer(productVersion, hotFixes, componentVersions)
	{
		var theOutput = "<B>Product Version:</b> " + productVersion + "<P>";
		theOutput = theOutput + "<b>Hot Fixes:</b><P>";
		for (var i=0; i<hotFixes.length; i = i + 1)
		{
			theOutput = theOutput + "  Hot Fix: " + hotFixes[i] + "<BR>";
		}
		theOutput = theOutput + "<P>";
		theOutput = theOutput + "<b>Installed Components:</b><P>";
		for (var j=0; j<componentVersions.length; j = j + 1)
		{
			theOutput = theOutput + "  Component: " + componentVersions[j][0] + ': ' + componentVersions[j][1] + "<BR>";
		}
		outputDiv.innerHTML = theOutput;
	}
		  
	function getVer()  
	{
		generic.InvokeMETAFunction("Application", "VersionEvent:url('javascript:fnVer('%s', %s, %s);'); GetVersion");
	}
	
	//  JSON JSON JSON JSON JSON JSON JSON JSON JSON JSON JSON JSON

	function fnVerJSON(jsonObject)
	{
		alert(jsonObject);
		var theOutput = "<B>Product Version:</b> " + jsonObject.productVersion + "<P>";

		theOutput = theOutput + "<b>Hot Fixes:</b><P>";
		for (var i=0; i<jsonObject.hotFixes.length; i = i + 1)
		{
			theOutput = theOutput + "  Hot Fix: " + jsonObject.hotFixes[i] + "<BR>";
		}
		theOutput = theOutput + "<P>";
		theOutput = theOutput + "<b>Installed Components:</b><P>";
		for (var j=0; j<jsonObject.componentVersions.length; j = j + 1)
		{
			theOutput = theOutput + "  Module: " + jsonObject.componentVersions[j].module + ', Version: ' + jsonObject.componentVersions[j].version + "<BR>";
		}

		outputDiv.innerHTML = theOutput;
	}
	
	function getVerJSON()  
	{
		generic.InvokeMETAFunction("Application", "VersionEvent:url('javascript:fnVerJSON(%json);'); GetVersion");
	}
	
	function getVerJSONWindow()  
	{
		generic.InvokeMETAFunction("Application", "VersionEvent:url('javascript:window.doScan(%json);'); GetVersion");
	}

	function getVerJSONClear()  
	{
		application.versionEvent = "fnVerJSON(%json);";
		application.getVersion();
		application.versionEvent = "";
	}

  
  </script>
</HEAD>

<H1>Version Tests</H1>
<P>
<div id="outputDiv">Version Goes Here</div>
<P>
  <INPUT align="center" type="button" value="Retrieve Version (JS Array)" onclick="getVer();"><br>
  <INPUT align="center" type="button" value="Retrieve Version (JSON)" onclick="getVerJSON();"><br>
  <INPUT align="center" type="button" value="Retrieve Version (non existent window event)" onclick="getVerJSONWindow();"><br>
  <INPUT align="center" type="button" value="Retrieve Version (with clear) (JSON)" onclick="getVerJSONClear();"><br>
<br>  
  <INPUT align="center" type="button" value="Manual Test (JS Array)" onclick="fnVer('1.2.3', new Array('1','2'), new Array(new Array('hello','darryn'),new Array('greetings','darryns friend')));"><br>
  <INPUT align="center" type="button" value="Manual Test (JSON)" onclick="fnVerJSON({'productVersion':'1.2.3','hotFixes':['7','4','2'],'componentVersions':[{'module':'Timer','version':'1.0.6.1'},{'module':'Scanner','version':'1.0.6.5'}]});"><br>

	<P>
	<a href="javascript:location.reload();">Refresh the page</a> | <a href="http://www.jrq768.wtgdev.net">Main JRQ768 Page</a>
<br>This page has been modified to work either with ActiveX or with an inherent 'Generic' object.





</HTML>